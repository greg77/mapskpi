<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  </head>

  <body>
    <div id="map"></div>
    <script src="./js/jquery.js"></script>
    <script type="text/javascript" async>
var lato;
var longo;

var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : sParameterName[1];
        }
    }
};


var map;
function initMap() {
  var listFail = getUrlParameter('fail');
  alert(listFail);
 var listFailArr = listFail.split("|");
 console.log(listFailArr);
  //alert(lato);
  //alert(longo);
  map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 45.750000, lng: 4.850000},
    zoom: 8
  });
  
//  alert('plop');
var listFailArr_count = listFailArr.length;
alert('taille: '+listFailArr_count);
for (var i = 0; i < listFailArr_count; i++) {
    fail = listFailArr[i];
    locArr = fail.split(",");
    lato= parseFloat(locArr[0]);
    longo= parseFloat(locArr[1]);
    alert('location:'+lato+' '+longo);
//    marker = new google.maps.Marker({
//        position: new google.maps.LatLng(lato, longo),
//        map: map
//      });
      
    addMarker("fail",lato,longo);

     
   
}
}

function addMarker(type,lat,long) {
   pinColor = "FE7569";
   
    if (new String(type).valueOf() == new String("fail").valueOf()){
        pinColor = "00FF00";
    }
    
   pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor,
   new google.maps.Size(21, 34),
    new google.maps.Point(0,0),
    new google.maps.Point(10, 34));
    
   marker = new google.maps.Marker({
        position: new google.maps.LatLng(lat, long),
        map: map,
        icon: pinImage
      });
}

    </script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDA6fTTJgYVEjmG01er3s3MNAtxVuWETqw&callback=initMap">
    </script>
  </body>
</html>